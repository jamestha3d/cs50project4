{% extends "network/layout.html" %}

{% block body %}
     {% if user.is_authenticated %}
{% load load_functions %}



<div class="dashboard"class="index prepost">
    <h3>New Post</h3>
    <form action="{% url 'make_post' %}" method="post">
        <div class="form-group">
        {% csrf_token %}
        {{ form }}    
        <button class="btn btn-sm" type="submit" style="float: right; margin-top: 10px; background-color: #ddf4ff"> <i class="fas fa-pen"></i> Post </button>
        </div>
    </form>
    

</div>
    
    <div class="postcontainer">
        <div> <h3 style="text-align: center; padding: 20px 0px 10px 0px;"> All Posts</h3></div>

        {% for post in posts %}
        <div class="posts  ">
            <div class="posthead" >
                <div class="poster {%if post.poster.id == user.id%} mypost {% endif %}">
                    <div>
                        <a class="postername {%if post.poster.id == user.id%} me{% endif %}" href="{% url 'user' post.poster.username %}"> {{post.poster.username.capitalize}}</a>
                        {% if post.poster.id == user.id %}
                        <span class="trashcan fa-solid fa-trash-can" data-postid="{{post.id}}"></span>
                        {% endif %}
                        <a class="date" style="color: darkgrey;">
                            {{post.time}}
                        </a>
                        <span class="edit">
                        {% if post.poster.id == user.id %}
                        <button class="editlink btn btn-light btn-sm btn-sml" style="font-size: 12px; padding: 0px 5px; margin: 0px 20px;"> Edit </button>
                        {% endif %}
                        </span> 
                    </div>

                </div><div id ="postdiv{{post.id}}" class="postcontent" data-postid="{{post.id}}">
                    <a> {{post.content.capitalize}}</a>
                </div>  
                
            </div>
            <div class="postbody">

                <div class="like">
                    <span class="likebutton" data-userid="{{user.id}}" data-postid={{post.id}}> 
                        {% if user in post.id|likers %}
                        <i class="fa-solid fa-heart"></i>
                        {% else %}
                        <i class="far fa-heart"></i>
                        {% endif %}
                    </span><a class="postlikesnum" style="color: darkgrey"> {{post.likes}}</a>
                    
                        <a style="cursor: pointer; float:right; color: lightgrey;"> 0 Comments</a> 

                    
                    
                    
                </div>


                
            </div>
          </div>


        {% empty %}
        <h3> No Posts</h3>
        {% endfor %}

        
            {% if posts.has_other_pages %}

            <div style="float: right; margin: 10px 30px 0px 0px; font-size: 14px; padding: 0px;">
            <ul class="pagination pagination-sm">
            {% if posts.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{posts.previous_page_number}}" aria-label="Previous">&laquo;</a>
            </li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
            {% endif %}
            {% for i in posts.paginator.page_range %}
              {% if posts.number == i %}
                <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span></li>
              {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
              {% endif %}
            {% endfor %}
            {% if posts.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ posts.next_page_number }}">&raquo;</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
            {% endif %}
            </ul>

            {% endif %}
        
            </div>
    </div>





    

      {% endif %}

{% endblock %}


